\Configure{HEAD}{\empty}{\empty}
\Configure{HTML}{\StartXml}{\EndXml}

\newcommand\StartXml{\IgnorePar\HCode{%
<FictionBook xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.gribuser.ru/xml/fictionbook/2.0">\Hnewline
<description/>}}  %description is created via xsl transformation

\newcommand\EndXml{\empty} % the end tag is inserted from the Makefile \HCode{</FictionBook>}}

\Configure{TITLE+}{\empty}
\Configure{TITLE}{\empty}


\Preamble{xhtml,fn-in,-css,no-DOCTYPE,charset=utf-8,enumerate+}

\Configure{part}
    {\IgnorePar \HCode{\Hnewline<section>}}
    {\EndP\IgnorePar \HCode{\Hnewline</section>}}
   {\ifvmode \IgnorePar\fi \EndP\IgnorePar
    \HCode{\Hnewline<title><p>}}
   {\HCode{</p></title>} \IgnoreIndent \ShowPar\par}

\Configure{chapter}
    {\IgnorePar \HCode{\Hnewline<section>}}
    {\EndP\IgnorePar \HCode{\Hnewline</section>}}
   {\ifvmode \IgnorePar\fi \EndP\IgnorePar
    \HCode{\Hnewline<title><p>}}
   {\HCode{</p></title>} \IgnoreIndent \ShowPar\par}
    
\Configure{section}
    {\IgnorePar \HCode{\Hnewline<section>}}
    {\EndP\IgnorePar \HCode{\Hnewline</section>}}
   {\ifvmode \IgnorePar\fi \EndP\IgnorePar
    \HCode{\Hnewline<title><p>}}
   {\HCode{</p></title>} \IgnoreIndent \ShowPar\par}

\Configure{subsection}
    {\IgnorePar \HCode{\Hnewline<section>}}
    {\EndP\IgnorePar \HCode{\Hnewline</section>}}
   {\ifvmode \IgnorePar\fi \EndP\IgnorePar
    \HCode{\Hnewline<title><p>}}
   {\HCode{</p></title>} \IgnoreIndent \ShowPar\par}

\Configure{subsubsection}
    {}
    {}
   {\ifvmode \IgnorePar\fi \EndP\IgnorePar
    \HCode{\Hnewline<subtitle>}}
   {\HCode{</subtitle>} \IgnoreIndent \ShowPar\par}
   
\ConfigureEnv{quote}
    {\EndP\HCode{<empty-line/>}\MyHtmpParV}
    {\EndP\HCode{<empty-line/>}\MyHtmpParP}
    {\empty}
    {\empty}

%
% hook config for \emph{} command
%
\renewcommand{\emph}[1]{\HCode{<emphasis>}#1\HCode{</emphasis>}}

%
% hook config for \myemph{} command
%
\newcommand{\myemph}[1]{\emph{#1}}

%
% hook config for \textbf{} command
%
\renewcommand{\textbf}[1]{\HCode{<strong>}#1\HCode{</strong>}}

\newcommand{\MyHtmlParBegin}{\HCode{<p>}}
\newcommand{\MyHtmlParEnd}{\HCode{</p>}}
\newcommand{\MyHtmpParP}
  {\renewcommand{\MyHtmlParBegin}{\HCode{<p>}}%
  \renewcommand{\MyHtmlParEnd}{\HCode{</p>}}}
\newcommand{\MyHtmpParV}
  {\renewcommand{\MyHtmlParBegin}{\HCode{<v>}}%
  \renewcommand{\MyHtmlParEnd}{\HCode{</v>}}}

\Configure{HtmlPar}
  {\EndP \MyHtmlParBegin}
  {\EndP \MyHtmlParBegin}
  {\MyHtmlParEnd}
  {\MyHtmlParEnd}

\Configure{textsuperscript}
  {\empty}
  {\empty}
  
\ConfigureList{enumerate}
  {\EndP\HCode{\Hnewline<empty-line/>}\MyHtmpParV}
  {\EndP\HCode{\Hnewline<empty-line/>}\MyHtmpParP}
  {\EndP\par}
  {\empty}

\ConfigureList{description}
  {\EndP\HCode{\Hnewline<empty-line/>}\MyHtmpParV}
  {\EndP\HCode{\Hnewline<empty-line/>}\MyHtmpParP}
  {\EndP\par}
  {\empty}

\ConfigureList{itemize}
  {\EndP\HCode{\Hnewline<empty-line/>}\MyHtmpParV}
  {\EndP\HCode{\Hnewline<empty-line/>}\MyHtmpParP}
  {\EndP\par}
  {\empty}
  
\Configure{hbar}
  {\HCode{\string&\#x2015;}}
  
\newcommand{\myparsep}[1]{%
  \EndP\HCode{<subtitle>}%
    \hbar\hbar\hbar\hbar
  \HCode{</subtitle>}}
  
%
% in html, acute accenting can be achieved
% by placing &#x301; unicode value after desired character
% we redefine \'{} command and create new hook configuration
%
\renewcommand{\'}[1]{#1\HCode{&\#x301;}}

\renewcommand{\url}[1]{\emph{#1}}

\begin{document}

\EndPreamble 
